from bs4 import BeautifulSoup
from selenium import webdriver


def get_vulnerability_count(groupId,artifactId,version):
    url = 'https://mvnrepository.com/artifact/'+groupId+'/'+artifactId+''
    dr = webdriver.Chrome()
    dr.get(url)
    soup = BeautifulSoup(dr.page_source, 'html.parser')
    # tbody = soup.find('tbody')
    tbodys = soup.findAll('tbody')

    vulnerability_count = 0
    for tbody in tbodys:
        for tr in tbody.find_all('tr'):
            version_element = tr.find('a', class_='vbtn release')
            if version_element and version_element.text.strip() == version:
                vulnerability_element = tr.find('a', class_='vuln')
                if vulnerability_element:
                    vulnerability_text = vulnerability_element.text.strip()
                    vulnerability_count = int(vulnerability_text.split()[0])
                break

    return vulnerability_count


# Example usage
version = '2.4.0'
count = get_vulnerability_count(version)
print(f"Vulnerability count for version {version}: {count}")
